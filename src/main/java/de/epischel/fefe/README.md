various attempts for implementing algorithm see http://ptrace.fefe.de/wp/README.txt